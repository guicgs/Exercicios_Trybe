(this["webpackJsonplearn-react-hooks"]=this["webpackJsonplearn-react-hooks"]||[]).push([[34],{101:function(n,e,t){"use strict";t.d(e,"a",(function(){return d}));var a=t(0),s=t.n(a);function o(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,a)}return t}function r(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?c(Object(t),!0).forEach((function(e){o(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function l(n,e){if(null==n)return{};var t,a,s=function(n,e){if(null==n)return{};var t,a,s={},o=Object.keys(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||(s[t]=n[t]);return s}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}var p=s.a.createContext({}),i=function(n){var e=s.a.useContext(p),t=e;return n&&(t="function"===typeof n?n(e):r({},e,{},n)),t},u={inlineCode:"code",wrapper:function(n){var e=n.children;return s.a.createElement(s.a.Fragment,{},e)}},h=Object(a.forwardRef)((function(n,e){var t=n.components,a=n.mdxType,o=n.originalType,c=n.parentName,p=l(n,["components","mdxType","originalType","parentName"]),h=i(t),d=a,b=h["".concat(c,".").concat(d)]||h[d]||u[d]||o;return t?s.a.createElement(b,r({ref:e},p,{components:t})):s.a.createElement(b,r({ref:e},p))}));function d(n,e){var t=arguments,a=e&&e.mdxType;if("string"===typeof n||a){var o=t.length,c=new Array(o);c[0]=h;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=n,r.mdxType="string"===typeof n?n:a,c[1]=r;for(var p=2;p<o;p++)c[p]=t[p];return s.a.createElement.apply(null,c)}return s.a.createElement.apply(null,t)}h.displayName="MDXCreateElement"},102:function(n,e,t){"use strict";function a(n,e){if(null==n)return{};var t,a,s=function(n,e){if(null==n)return{};var t,a,s={},o=Object.keys(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||(s[t]=n[t]);return s}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}t.d(e,"a",(function(){return a}))},75:function(n,e,t){"use strict";t.r(e),t.d(e,"readingTime",(function(){return o})),t.d(e,"default",(function(){return r})),t.d(e,"tableOfContents",(function(){return l})),t.d(e,"frontMatter",(function(){return p}));var a=t(102),s=(t(0),t(101)),o={text:"4 min read",minutes:3.115,time:186900,words:623},c={};function r(n){var e=n.components,t=Object(a.a)(n,["components"]);return Object(s.a)("wrapper",Object.assign({},c,t,{components:e,mdxType:"MDXLayout"}),Object(s.a)("h1",{id:"useeffect-http-requests"},"useEffect: HTTP requests"),Object(s.a)("h2",{id:"background"},"Background"),Object(s.a)("p",null,"HTTP requests are another common side-effect that we need to do in applications.\nThis is no different from the side-effects we need to apply to a rendered DOM or\nwhen interacting with browser APIs like localStorage. In all these cases, we do\nthat within a ",Object(s.a)("inlineCode",{parentName:"p"},"useEffect")," hook callback. This hook allows us to ensure that\nwhenever certain changes take place, we apply the side-effects based on those\nchanges."),Object(s.a)("p",null,"One important thing to note about the ",Object(s.a)("inlineCode",{parentName:"p"},"useEffect")," hook is that you cannot return\nanything other than the cleanup function. This has interesting implications with\nregard to async/await syntax:"),Object(s.a)("pre",null,Object(s.a)("code",Object.assign({parentName:"pre"},{className:"language-javascript","data-language":"javascript","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token comment">// this does not work, don\'t do this:</span>\nReact<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">doSomeAsyncThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token comment">// do something with the result</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n'}}))),Object(s.a)("p",null,"The reason this doesn\u2019t work is because when you make a function async, it\nautomatically returns a promise (whether you\u2019re not returning anything at all,\nor explicitly returning a function). This is due to the semantics of async/await\nsyntax. So if you want to use async/await, the best way to do that is like so:"),Object(s.a)("pre",null,Object(s.a)("code",Object.assign({parentName:"pre"},{className:"language-javascript","data-language":"javascript","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">doSomeAsyncThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token comment">// do something with the result</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n'}}))),Object(s.a)("p",null,"This ensures that you don\u2019t return anything but a cleanup function."),Object(s.a)("p",null,"\ud83e\udd89 I find that it\u2019s typically just easier to extract all the async code into a\nutility function which I call and then use the promise-based ",Object(s.a)("inlineCode",{parentName:"p"},".then")," method\ninstead of using async/await syntax:"),Object(s.a)("pre",null,Object(s.a)("code",Object.assign({parentName:"pre"},{className:"language-javascript","data-language":"javascript","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">doSomeAsyncThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token comment">// do something with the result</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n'}}))),Object(s.a)("p",null,"But how you prefer to do this is totally up to you :)"),Object(s.a)("h2",{id:"exercise"},"Exercise"),Object(s.a)("p",null,"In this exercise, we\u2019ll be doing data fetching directly in a useEffect hook\ncallback within our component."),Object(s.a)("p",null,"Here we have a form where users can enter the name of a pokemon and fetch data\nabout that pokemon. Your job will be to create a component which makes that\nfetch request."),Object(s.a)("h2",{id:"extra-credit"},"Extra Credit"),Object(s.a)("h3",{id:"-handle-errors"},"\ud83d\udcaf handle errors"),Object(s.a)("p",null,"Unfortunately, sometimes things go wrong and we need to handle errors when they\ndo so we can show the user useful information. Handle that error and render it\nout like so:"),Object(s.a)("pre",null,Object(s.a)("code",Object.assign({parentName:"pre"},{className:"language-jsx","data-language":"jsx","data-highlighted-line-numbers":"",dangerouslySetInnerHTML:{__html:'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n  There was an error: </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>error<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n'}}))),Object(s.a)("h3",{id:"-use-a-status"},"\ud83d\udcaf use a status"),Object(s.a)("p",null,"Our logic for what to show the user when is kind of convoluted and requires that\nwe be really careful about which state we set and when."),Object(s.a)("p",null,'We could make things much simpler by having some state to set the explicit\nstatus of our component. Our component can be in the following "states":'),Object(s.a)("ul",null,Object(s.a)("li",{parentName:"ul"},Object(s.a)("inlineCode",{parentName:"li"},"idle"),": no request made yet"),Object(s.a)("li",{parentName:"ul"},Object(s.a)("inlineCode",{parentName:"li"},"pending"),": request started"),Object(s.a)("li",{parentName:"ul"},Object(s.a)("inlineCode",{parentName:"li"},"resolved"),": request successful"),Object(s.a)("li",{parentName:"ul"},Object(s.a)("inlineCode",{parentName:"li"},"rejected"),": request failed")),Object(s.a)("p",null,"Try to use a status state by setting it to these string values rather than\nrelying on existing state or booleans."),Object(s.a)("p",null,"Learn more about this concept here:\n",Object(s.a)("a",Object.assign({parentName:"p"},{href:"https://kentcdodds.com/blog/stop-using-isloading-booleans"}),"https://kentcdodds.com/blog/stop-using-isloading-booleans")),Object(s.a)("h3",{id:"-store-the-state-in-an-object"},"\ud83d\udcaf store the state in an object"),Object(s.a)("p",null,"You\u2019ll notice that we\u2019re calling a bunch of state updaters in a row. It\u2019d be\nnice to just put all that state in one object so we only have to call one\nfunction to update all the state at once."),Object(s.a)("p",null,"In the future, you\u2019ll learn about how ",Object(s.a)("inlineCode",{parentName:"p"},"useReducer")," can solve this problem really\nelegantly, but we can still accomplish this by storing our state as an object\nthat has all the properties of state we\u2019re managing."),Object(s.a)("p",null,"See if you can figure out how to store all of your state in a single object with\na single ",Object(s.a)("inlineCode",{parentName:"p"},"React.useState")," call."),Object(s.a)("h2",{id:"\ud83e\udd89-elaboration-and-feedback"},"\ud83e\udd89 Elaboration and Feedback"),Object(s.a)("div",null,Object(s.a)("span",null,"After the instruction, if you want to remember what you've just learned, then "),Object(s.a)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://ws.kcd.im/?ws=React%20Hooks%20%F0%9F%8E%A3&e=06%3A%20useEffect%3A%20HTTP%20requests&em="},"fill out the elaboration and feedback form.")))}r.isMDXComponent=!0;var l=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[{id:"background",level:2,title:"Background",children:[]},{id:"exercise",level:2,title:"Exercise",children:[]},{id:"extra-credit",level:2,title:"Extra Credit",children:[{id:"-handle-errors",level:3,title:"\ud83d\udcaf handle errors",children:[]},{id:"-use-a-status",level:3,title:"\ud83d\udcaf use a status",children:[]},{id:"-store-the-state-in-an-object",level:3,title:"\ud83d\udcaf store the state in an object",children:[]}]},{id:"\ud83e\udd89-elaboration-and-feedback",level:2,title:"\ud83e\udd89 Elaboration and Feedback",children:[]}]},p={}}}]);
//# sourceMappingURL=34.5ae18dbb.chunk.js.map